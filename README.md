<h3 align="center">
	<img src="images/logo.png" alt="Logo"/><br/>
<br/>
  Guess the <a href="https://en.wikipedia.org/wiki/Overwatch_League">Overwatch League</a> (OWL) player using a series of clues (like the players team, role, country and region). Resets every day at midnight.
  <br />

</h3>

<h6 align="center">
  <a href="#showcase">Showcase</a>
  ¬∑
  <a href="#features">Features</a>
  ¬∑
  <a href="#getting-started">Getting Started</a>
  ¬∑
  <a href="#about">About</a>
  .
  <a href="#about">Sponsor me</a>
</h6>

<p align="center">
  <img src="images/temp_spacer.png" width="400" height="9" />
</p>

<p align="center">
	<a href="">
		<img alt="Stargazers" src="https://img.shields.io/github/stars/benschlegel/OWLDLE?style=for-the-badge&logo=starship&color=C9CBFF&logoColor=D9E0EE&labelColor=302D41"></a>
	<a href="">
		<img alt="Releases" src="https://img.shields.io/github/release/benschlegel/OWLDLE.svg?style=for-the-badge&logo=github&color=F2CDCD&logoColor=D9E0EE&labelColor=302D41"/></a>
	<a href="">
		<img alt="Issues" src="https://img.shields.io/github/issues/benschlegel/OWLDLE?style=for-the-badge&logo=gitbook&color=B5E8E0&logoColor=D9E0EE&labelColor=302D41"/></a>
	<a href="">
		<img alt="Commits" src="https://img.shields.io/github/commit-activity/t/benschlegel/OWLDLE?style=for-the-badge&logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNEOUUwRUUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0ibHVjaWRlIGx1Y2lkZS1naXQtZm9yayI+PGNpcmNsZSBjeD0iMTIiIGN5PSIxOCIgcj0iMyIvPjxjaXJjbGUgY3g9IjYiIGN5PSI2IiByPSIzIi8+PGNpcmNsZSBjeD0iMTgiIGN5PSI2IiByPSIzIi8+PHBhdGggZD0iTTE4IDl2MmMwIC42LS40IDEtMSAxSDdjLS42IDAtMS0uNC0xLTFWOSIvPjxwYXRoIGQ9Ik0xMiAxMnYzIi8+PC9zdmc+&color=DDB6F2&logoColor=D9E0EE&labelColor=302D41"/></a>
  <a href="">
    <img src="https://img.shields.io/github/contributors/benschlegel/OWLDLE?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNEOUUwRUUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0ibHVjaWRlIGx1Y2lkZS11c2VyIj48cGF0aCBkPSJNMTkgMjF2LTJhNCA0IDAgMCAwLTQtNEg5YTQgNCAwIDAgMC00IDR2MiIvPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCIvPjwvc3ZnPg==&logoColor=fff&style=for-the-badge&labelColor=302D41&color=7dc4e4" alt="Contributors"/></a>
  <a href="https://github.com/benschlegel/OWLDLE/blob/main/tests/report.json">
    <img src="https://img.shields.io/badge/dynamic/json?url=https%3A%2F%2Fraw.githubusercontent.com%2Fbenschlegel%2FOWLDLE%2Frefs%2Fheads%2Fmain%2Ftests%2Freport.json&query=%24.numPassedTests&suffix=%20passing&style=for-the-badge&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNkOWUwZWUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0ibHVjaWRlIGx1Y2lkZS1mbGFzay1jb25pY2FsIj48cGF0aCBkPSJNMTAgMnY3LjUyN2EyIDIgMCAwIDEtLjIxMS44OTZMNC43MiAyMC41NWExIDEgMCAwIDAgLjkgMS40NWgxMi43NmExIDEgMCAwIDAgLjktMS40NWwtNS4wNjktMTAuMTI3QTIgMiAwIDAgMSAxNCA5LjUyN1YyIi8%2BPHBhdGggZD0iTTguNSAyaDciLz48cGF0aCBkPSJNNyAxNmgxMCIvPjwvc3ZnPg%3D%3D&logoColor=302D41&label=Tests&labelColor=%23302D41&color=%23a6da95
    " alt="Number of passing tests"/></a>
  <a href="https://owldle.bschlegel.com/">
    <img src="https://img.shields.io/badge/View%20Website-000?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNEOUUwRUUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0ibHVjaWRlIGx1Y2lkZS1nbG9iZSI+PGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiLz48cGF0aCBkPSJNMTIgMmExNC41IDE0LjUgMCAwIDAgMCAyMCAxNC41IDE0LjUgMCAwIDAgMC0yMCIvPjxwYXRoIGQ9Ik0yIDEyaDIwIi8+PC9zdmc+&logoColor=fff&style=for-the-badge&labelColor=302D41&color=eed49f" alt="Link to website"/></a>

</p>

## Showcase

| ![Showcase 1 (Showing screenshot of game)](images/showcase1.png) | ![Showcase 2 (Showing screenshot of game in light mode)](images/showcase2.png) |
| --- | --- |
| ![Showcase 3 (Showing victory screen)](images/showcase3.png) | ![Showcase 3 (Showing mobile layout)](images/showcase4.png) |



## Features

This project was built using [`Next.js`](https://nextjs.org/) and [`tailwindcss`](https://tailwindcss.com/). Components are based on [`shadcn/ui`](https://ui.shadcn.com/). Tests were written with [`vitest`](https://vitest.dev/) and [`bun`](https://bun.sh/) is used instead of `npm`.

Major features are:

- üé® Consistent and dynamic themes (light + dark mode)
  - All components use theme colors and automatically switch to correct theme
- üì± Fully responsive
  - Works and looks good on any screen size (desktop + mobile + everything in-between)
- üõ¢ Dynamic database scheme
  - Supports dynamic game iteration length (e.g. default to 1 reset per day, but can have more on event day)
  - Supports multiple datasets (e.g. different seasons)
  - saves iteration data to log (iteration number, correct player, time of reset)
- üïµ Anonymous game result collection (game result + guesses, no information that could identify users)
  - Scheme can be found under `types/database` (`type DbLoggedGame`)
  - saved using `lib/databaseAccess.ts` (`function logGame()`)
- üé≤ Batched pseudo random selection
  - Random backlog of players generated (to keep the game from being stale but also to avoid duplicate players for `backlog.length` iterations)
- üõ†Ô∏è Easily configurable
  - The behavior of the game can easily be adjusted by changing values in `game.config.json`
  - Check `lib/config.ts` to find out more info about the config.
- ü¶ø Following modern accessiblity recommendations
  - Fully compatible with screen readers
  - Entire website can be navigated/used with keyboard inputs only
- üïµ Anonymous + EU compliant analytics (using [`Plausible`](https://plausible.io/))
- ‚ö° Blazingly fast through server side rendering + vercel edge functions/distributed servers
- üìÉ Follows modern SEO standards
  - Automatically generates `robots.txt` (through `robots.ts`)
  - Automatically generates sitemap (through `sitemap.ts`)
  - Uses site metadata (preview image, title, description, etc)
- üß™ Contains tests for critical functionality
  - Can be configured to automatically write test report/be ran through Github actions
  - Tests for:
    - Main game process + results
    - Checks to ensure all images (even from country flag api) still work
    - Database functions
- ‚ö†Ô∏è Full error handling
  - All invalid input errors are caught client side (with toasts that show what went wrong, works on desktop and mobile) + server side (zod schema validation for all api post endpoints)
  - Rate limit on all api endpoints to increase stability
- and more!


## Getting Started

First, clone the project locally and install dependencies. If you're only working locally, you can also use npm/pnpm/yarn, but this project was built and tested with bun.

```bash
bun install
# or
npm install
```

### env
Before starting the project, make sure you provide the following values to the environment (either directly or by creating a file called `.env.local` in the project root folder):

```bash
MONGO_URI="<your_mongo_uri>"
CRON_SECRET="<your_cron_secret>"
# optional
ADMIN_API_TOKEN="<your_secret>"
```

The only *strictly necessary* entry is `MONGO_URI` (as you won't have a database otherwise), so make sure you provide a valid [`Mongodb`](https://www.mongodb.com/) [connection uri](https://www.mongodb.com/docs/manual/reference/connection-string/).

When trying to use this project in production, you should provide `CRON_SECRET`. This secret gets used in the `api/cron` path, which is responsible for resetting the game periodically (e.g. once per day).

The `ADMIN_API_TOKEN` can be used to secure the (WIP, not yet implemented) admin dashboard and can be skipped for now.

---
After setting up your environment and installing all dependencies, you can start the project like this:

```bash
bun run dev
# or
npm run dev
```

You should now be able to see the website running on `localhost:3000`.

To built the project, you can run
```bash
bun run build
bun run start
# or
npm run build
npm run start
```

## Tests
This project contains tests for the major features under `tests/*.test.ts`. Tests that only run locally are postfixed by `*.local.test.ts` to allow filtering when running tests and ensure local tests always run with maximum performance.

To run tests, run
```bash
bun run test:local # only runs local tests
# or
bun run test # runs all tests
# or (using npm)
npm run test:local # only runs local tests
# or
npm run test # runs all tests
```

I also created a custom test reporter, which writes the following fields to `tests/report.json`:

```json
{
  "numTotalTests": "<total test amount>",
  "numPassedTests": "<passed test amount>",
  "numFailedTests": "<failed test amount>",
  "numPendingTests": "<pending test amount (should always be 0)"
}
```

To execute all tests with the custom reporter, run
```bash
bun run test:write
# or
npm run test:write
```

You should now see the updated report under `tests/report.json`.

## About

Docs coming soon

## Sponsor me
If you like this project, you can support me here

<a href="https://ko-fi.com/bschlegel">
<img src="https://img.shields.io/badge/Buy%20Me%20A%20Coffee-000?logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNEOUUwRUUiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0ibHVjaWRlIGx1Y2lkZS1jb2ZmZWUiPjxwYXRoIGQ9Ik0xMCAydjIiLz48cGF0aCBkPSJNMTQgMnYyIi8+PHBhdGggZD0iTTE2IDhhMSAxIDAgMCAxIDEgMXY4YTQgNCAwIDAgMS00IDRIN2E0IDQgMCAwIDEtNC00VjlhMSAxIDAgMCAxIDEtMWgxNGE0IDQgMCAxIDEgMCA4aC0xIi8+PHBhdGggZD0iTTYgMnYyIi8+PC9zdmc+&logoColor=D9E0EE&style=for-the-badge&labelColor=302D41&color=f5a97f" alt="Link to Ko-fi"/></a>
</a>
